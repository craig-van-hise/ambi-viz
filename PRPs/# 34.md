# Product Requirements Prompt (PRP): Tracking Indicator & UI Alignment (Amended)

## 1. Project Context & Objectives
Synchronize visual telemetry with the functional binaural audio rendering. The system is already in "Stationary World" mode (camera locked at origin). This task focuses on fixing visual pitch inversion, implementing 3-axis roll for the pentagon indicator, syncing UI sliders to head telemetry, and dynamically renaming the UI card to reflect reality.

## 2. Technical Decisions & Dependencies
* **Visual Pitch Inversion**: Invert the Y-axis rotation logic for the visual indicator meshes (`ActualArrow`/`GhostArrow`) to align with the correct audio pitch.
* **Pentagon Roll Implementation**: 
    * Apply 3-axis rotation to the pentagonal indicator.
    * Pivot: Rotate around its center axis.
    * Guide: The "top" apex/corner of the pentagon is the orientation guide.
* **Telemetry Sync & Decoupling**:
    * When `isTracking` is true, sliders reflect tracker data in real-time.
    * Sliders must be "read-only" (pointer-events disabled) during tracking to prevent feedback loops.
* **Dynamic UI Labeling**:
    * Condition: If `viewMode === 'inside'` AND `isTracking === true`, rename the "Camera Orientation" card to **"Head Orientation"**.
    * Otherwise, keep/revert to "Camera Orientation".

## 3. Implementation Phases

### Phase 1: Visual Pitch & Roll Alignment
* **Objective**: Fix inverted pitch and enable roll for the indicator.
* **Instructions**:
    1.  In `AmbiScene.ts`, locate the `ActualArrow` and `GhostArrow` (pentagon) meshes.
    2.  **Invert Pitch**: Flip the sign of the pitch value applied to the mesh (e.g., `mesh.rotation.x = -trackerPitch`) so "Up" on the tracker = "Up" visually.
    3.  **Enable Roll**: Apply the tracker's roll value to the mesh's Z-axis (`mesh.rotation.z = trackerRoll`). Ensure the pivot is centered.
* **TDD Checkpoint**:
    * **Test Case 1**: Given tracker Pitch "Up", Assert indicator tilts toward the top of the screen.
    * **Test Case 2**: Given tracker Roll is 15°, Assert pentagon rotates 15° around its center.

### Phase 2: Telemetry Sync & Dynamic Labeling
* **Objective**: Mirror head data in UI and update the UI card label.
* **Instructions**:
    1.  **Sync**: Update `App.tsx` state (`currentYaw/Pitch/Roll`) from `HeadTrackingService` every frame.
    2.  **Label Change**: In `CameraControlPanel.tsx`, add logic to change the title/header from "Camera Orientation" to **"Head Orientation"** when `isTracking` and `viewMode === 'inside'` are active.
    3.  **Decouple**: Disable slider interaction while `isTracking` is true.
* **TDD Checkpoint**:
    * **Test Case 1**: Given `isTracking` is true and `viewMode` is 'inside', Assert the UI card displays the title "Head Orientation".
    * **Test Case 2**: Given head turns left, Assert the Yaw slider moves to match the tracker value.

## 4. Final Review
* **Visual**: Does the pentagon follow your head (Pitch Up = Up, Roll = Roll)?
* **UI Context**: Does the card label correctly flip between "Camera" and "Head" orientation based on the tracking state?
* **Audio**: Confirm no changes were made to the (already correct) audio rendering.

**AGENT INSTRUCTION**: "Implement these visual and UI updates immediately. Ensure the label change is reactive to the tracking state."