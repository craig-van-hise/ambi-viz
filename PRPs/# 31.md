# Product Requirements Prompt (PRP): 3D Pointer Reconstruction & Frustum Validation

## 1. Project Context & Objectives
The previous attempt to restore the 3D Green Arrow failed; the mesh is not visible in the viewport. This phase mandates the reconstruction of the 3D pointer, strict parenting to the camera, and coordinate inversion for Yaw/Pitch/Roll to resolve the "backwards" audio-visual behavior.

## 2. Technical Decisions & System Integrity
* **Pointer Reconstruction:** If the original mesh code cannot be found, the agent MUST create a new `THREE.ConeGeometry(0.05, 0.2, 32)` with a `MeshBasicMaterial({ color: 0x00ff00 })`.
* **Frustum Safety:** The pointer MUST be parented to the camera: `this.camera.add(pointer)`. It must be positioned at `(0, 0, -1)` and rotated `Math.PI / 2` on the X-axis so the tip points forward into the scene.
* **Coordinate Inversion Logic:**
    * **Visual Pointer:** Map head tracking to the *pointer's* rotation. Apply `-1` multipliers to `yaw` and `pitch` until "Look Left" visually points the arrow "Left" on screen.
    * **Audio Path:** Invert the current `yaw` value sent to `OBRDecoder` to fix the binaural inversion (Look Left = Sound in Right Ear).
* **Stationary World:** Hard-lock `camera.rotation.set(0, 0, 0)` while tracking is active.

## 3. Implementation Phases

### Phase 1: Mesh Reconstruction & Visibility Test
* **Objective:** Ensure a 3D green arrow is physically rendered and visible at the center of the screen.
* **Instructions:**
    1. Re-create the pointer using a green `ConeGeometry`.
    2. Parent it to the `camera` and set `position.set(0, 0, -1)`.
    3. Ensure `this.scene.add(this.camera)` is called so the camera and its children are in the scene graph.
    4. Set `pointer.renderOrder = 999` and `material.depthTest = false` to ensure it is always visible on top of the ambisonic sphere.
* **TDD Checkpoint:**
    * **AGENT INSTRUCTION:** Write a test asserting `camera.children` contains the pointer mesh and that the mesh's `visible` property is `true`. Do not proceed until the agent confirms the mesh is initialized in the code.

### Phase 2: Axis Correction (Audio & Visual)
* **Objective:** Fix the inversions reported by the user.
* **Instructions:**
    1. **Audio:** Invert the `yaw` sign in the `OBRDecoder` rotation update.
    2. **Visual:** In `AmbiScene.ts`, update `pointer.rotation.y` and `pointer.rotation.x` using inverted tracker values.
    3. **Freeze:** Force `camera.rotation.set(0, 0, 0)` when `isTracking` is true.
* **TDD Checkpoint:**
    * **AGENT INSTRUCTION:** Write a unit test verifying that a "Left" tracker input results in a "Left" rotation for the pointer mesh and an inverted "Right" rotation for the OBR audio spatializer.

## 4. FINAL REVIEW: HUMAN QA HANDOFF
**AGENT INSTRUCTION:** You cannot see the screen. Halt and wait for the human.
> "I have reconstructed the **3D Green Arrow** and enforced its visibility as a HUD element. I have also flipped the Yaw/Pitch signs for both the pointer and the audio renderer.
> 
> **Human Developer, please perform these physical checks:**
> 1. **Visibility:** Do you see a 3D Green Arrow at the center of the screen?
> 2. **Visual Yaw:** Look Left. Does the 3D Green Arrow point Left?
> 3. **Visual Pitch:** Look Down. Does the 3D Green Arrow point Down?
> 4. **Audio Check:** Look Left. Does the sound source move to your **Right Ear**?
> 5. **Stationary View:** Does the background sphere remain still while you move?
> 
> Please reply with 'Pass' or 'Fail'.".
